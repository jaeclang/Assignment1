---
title: "assignment1"
format: html
editor: visual
---

# Introduction

```{r}
#| label: required-packages
#| message: false

library(tidyverse)
```

# Aggregating Information About Flights

## Unzip Data and Import all Extracted CSV Files

```{r}
#| label: unzip-and-import

flights <- read_csv("flights.csv")
airlines <- read_csv("airlines.csv")
airports <- read_csv("airports.csv")
planes <- read_csv("planes.csv")
weather <- read_csv("weather.csv")
```

## 2.5 Rankings of New York Cityâ€™s Main Airports by Mean Departure Delay

```{r}
#| label: rank-by-airports-mean-departure-delay

mean_delay <- flights %>%
  filter(!is.na(dep_delay)) %>%
  group_by(origin) %>%
  summarise(mean_departure_delay = mean(dep_delay, na.rm = TRUE)) %>%
  left_join(airports, by = c("origin" = "faa")) %>%
  arrange(mean_departure_delay, origin) %>%
  mutate(rank = rank(mean_departure_delay))

mean_delay %>%
  select(origin, name, mean_departure_delay, rank)
```

## 2.6 Percentage of On-Time Flights Despite Departure Delay

```{r}
#| label: rank-by-on-time-flights

on_time_flights <- flights %>%
  filter(dep_delay >= 30 & arr_delay <= 0) %>%
  summarise(Percentage = n() / nrow(flights) * 100)

print(on_time_flights)

```

## 2.7 On-Time Departure Percentage by Hour of the Day

```{r}
hourly_departures <- flights %>%
  filter(!is.na(dep_delay)) %>%
  mutate(OnTimeDeparture = dep_delay <= 0) %>%
  group_by(hour) %>%
  summarise(PercentageOnTime = mean(OnTimeDeparture) * 100) %>%
  arrange(hour)

print(hourly_departures)
```
